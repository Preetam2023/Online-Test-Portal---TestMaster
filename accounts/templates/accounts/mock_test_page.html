<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mock Test</title>
    <style>
        /* Updated styles */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f4f7f6;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .container {
            background-color: #ffffff;
            width: 100%;
            max-width: 900px;
            margin: 20px auto;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        h1 {
            font-size: 32px;
            color: #34C759;
            text-align: center;
            margin-bottom: 20px;
        }

        .instructions {
            margin-bottom: 20px;
            color: #333;
            line-height: 1.6;
        }

        .instructions p {
            margin: 10px 0;
        }

        .declaration {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .declaration input {
            margin-right: 10px;
        }

        .start-button {
            padding: 12px 20px;
            background-color: #34C759;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            display: none;
            margin: 0 auto;
            display: block;
        }

        .timer {
            font-size: 20px;
            color: red;
            text-align: center;
            margin-top: 10px;
            display: none;
        }

        .questions {
            margin-top: 30px;
            display: none;
        }

        .question {
            background-color: #f9f9f9;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 1px solid #ddd;
        }

        .question p {
            font-size: 18px;
            margin-bottom: 15px;
        }

        .question input {
            margin-right: 10px;
        }

        .submit-button {
            padding: 12px 20px;
            background-color: #34C759;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            display: none; /* Hidden initially */
            font-size: 16px;
            margin: 30px auto;
        }

        .submit-button[disabled] {
            background-color: #ccc;
            cursor: not-allowed;
        }

        .result {
            text-align: center;
            font-size: 20px;
            margin-top: 30px;
            display: none;
        }

        .more-tests {
            text-align: center;
            margin-top: 20px;
            display: none;
        }

        .more-tests button {
            padding: 10px 20px;
            background-color: #007aff;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
        }
    </style>
</head>
<body>

<div class="container">
    <h1 id="test-subject">Mock Test</h1>
    
    <div class="instructions">
        <p><strong>Instructions:</strong></p>
        <p>Please read the instructions carefully before starting the test.</p>
        <p>Declaration: I understand all the rules mentioned in the instructions.</p>
        <div class="declaration">
            <input type="checkbox" id="declaration" onchange="toggleStartButton()"> I agree
        </div>
        <button class="start-button" id="start-button" onclick="showQuestions()">Start Test</button>
    </div>
    
    <div class="timer" id="timer">Time Left: <span id="time">20:00</span></div>
    
    <div class="questions" id="questions"></div>
    
    <button class="submit-button" id="submit-button" onclick="submitTest()">Submit Test</button>
    
    <div class="result" id="result"></div>
    
    <div class="more-tests" id="more-tests">
        <button onclick="goBack()">More Mock Tests</button>
    </div>
</div>

<script>
    let timer;
    let timeLeft = 1200; // 20 minutes in seconds
    let score = 0;
    let selectedSubject = '';
    let questions = []; // Global variable to store questions

    // Get the subject from the URL parameters
    const urlParams = new URLSearchParams(window.location.search);
    selectedSubject = urlParams.get('subject');
    document.getElementById('test-subject').innerText = selectedSubject;

    // Hide Start Test button if declaration is not checked
    function toggleStartButton() {
        const declarationChecked = document.getElementById('declaration').checked;
        document.getElementById('start-button').style.display = declarationChecked ? 'block' : 'none';
    }

    // Show questions and start timer
    function showQuestions() {
        loadQuestions(selectedSubject);
        document.getElementById('submit-button').style.display = 'block'; // Show submit button only after test starts
        document.getElementById('start-button').style.display = 'none';   // Hide the start button
    }

    // Load and display questions for selected subject
    function loadQuestions(subject) {
        if (subject === 'C Programming') {
            questions = [
                { question: "What is the size of int in C?", options: ["2 bytes", "4 bytes", "8 bytes", "16 bytes"], answer: 1 },
                { question: "Which of the following is a loop structure in C?", options: ["if", "for", "while", "switch"], answer: 2 },
            ];
        } else if (subject === 'Data Structures') {
            questions = [
                { question: "What is the time complexity of binary search?", options: ["O(n)", "O(log n)", "O(n log n)", "O(1)"], answer: 1 },
                { question: "Which data structure is used to implement a stack?", options: ["Array", "Linked List", "Tree", "Graph"], answer: 1 },
            ];
        } else if (subject === 'DBMS') {
            questions = [
                { question: "What is the primary key in a database?", options: ["Unique identifier", "Foreign key", "Index", "View"], answer: 0 },
                { question: "Which database management system is widely used?", options: ["MySQL", "PostgreSQL", "Oracle", "Microsoft SQL Server"], answer: 0 },
            ];
        }

        const questionsHtml = questions.map((question, index) => {
            return `
                <div class="question">
                    <p>${question.question}</p>
                    <input type="radio" name="question${index}" value="${question.options[0]}">${question.options[0]}</input><br>
                    <input type="radio" name="question${index}" value="${question.options[1]}">${question.options[1]}</input><br>
                    <input type="radio" name="question${index}" value="${question.options[2]}">${question.options[2]}</input><br>
                    <input type="radio" name="question${index}" value="${question.options[3]}">${question.options[3]}</input>
                </div>
            `;
        }).join('');

        document.getElementById('questions').innerHTML = questionsHtml;
        document.getElementById('questions').style.display = 'block';
        document.getElementById('timer').style.display = 'block';
        startTimer();
    }

    // Start countdown timer
    function startTimer() {
        timer = setInterval(() => {
            timeLeft--;
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            document.getElementById('time').innerText = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            if (timeLeft === 0) {
                clearInterval(timer);
                submitTest();
            }
        }, 1000);
    }

    // Submit the test and calculate score
    function submitTest() {
        clearInterval(timer);
        const questionElements = document.querySelectorAll('.question');
        questionElements.forEach((questionElement, index) => {
            const radios = questionElement.querySelectorAll('input[type="radio"]');
            const selectedOption = Array.from(radios).find(radio => radio.checked);
            if (selectedOption && selectedOption.value === questions[index].options[questions[index].answer]) {
                score++;
            }
        });

        const totalQuestions = questions.length;
        const percentage = (score / totalQuestions) * 100;
        const resultElement = document.getElementById('result');
        resultElement.innerText = `You scored ${score} out of ${totalQuestions}. Percentage: ${percentage}%`;
        resultElement.style.display = 'block';

        // Show "More Mock Tests" button
        document.getElementById('more-tests').style.display = 'block';

        // Disable submit button after submitting
        const submitButton = document.getElementById('submit-button');
        submitButton.disabled = true;
        submitButton.style.backgroundColor = '#ccc';
    }

    function goBack() {
        window.location.href = "{% url 'mock_test' %}";  // Use Django template URL for going back to test selection
    }
</script>

</body>
</html>





